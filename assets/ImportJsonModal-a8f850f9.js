import{r as m,j as t,B as u,S}from"./index-d1e7d04e.js";function I(e){if(typeof e!="object"||e===null)return{ok:!1,error:"Item is not an object"};const o=[],h=typeof e.title=="string"&&e.title.trim()?String(e.title).trim():(o.push("title"),null),g=typeof e.description=="string"&&e.description.trim()?String(e.description).trim():(o.push("description"),null),y=typeof e.address=="string"?String(e.address).trim():(o.push("address"),null),v=typeof e.category=="string"?String(e.category).trim():(o.push("category"),null),f=e.priority==="low"||e.priority==="medium"||e.priority==="high"?e.priority:(o.push("priority (low|medium|high)"),null),p=Number.isFinite(e.estimatedDuration)&&e.estimatedDuration>0?Number(e.estimatedDuration):(o.push("estimatedDuration (>0 minutes)"),null),a=Number.isFinite(e.cost)&&e.cost>=0?Number(e.cost):(o.push("cost (>=0)"),null),j=typeof e.notes=="string"?String(e.notes):"",b=typeof e.isOpen=="boolean"?e.isOpen:!1,x=e.location&&typeof e.location=="object"&&Number.isFinite(e.location.lat)&&Number.isFinite(e.location.lng);x||o.push("location { lat:number, lng:number }");const N=x?{lat:Number(e.location.lat),lng:Number(e.location.lng)}:void 0;let s;if(e.openingHours&&typeof e.openingHours=="object"){s={};for(const[c,r]of Object.entries(e.openingHours)){if(r===null){s[c]=null;continue}r&&typeof r=="object"&&typeof r.open=="string"&&typeof r.close=="string"?s[c]={open:r.open,close:r.close}:o.push(`openingHours.${c} must be { open:string, close:string } or null`)}}return o.length?{ok:!1,error:`Invalid fields: ${o.join(", ")}`}:{ok:!0,value:{title:h,description:g,address:y,category:v,priority:f,estimatedDuration:p,cost:a,notes:j,isOpen:b,location:N,openingHours:s}}}function k({onClose:e,onImport:o}){const[h,g]=m.useState(""),[y,v]=m.useState(""),[f,p]=m.useState(null),[a,j]=m.useState(null),b=async n=>{const i=await n.text();v(n.name),g(i)},x=()=>{const n=[{title:"Example Activity",description:"A sample activity description",address:"123 Example Street, City, State",category:"Entertainment",priority:"medium",estimatedDuration:120,cost:25.5,notes:"Optional notes about this activity",isOpen:!0,location:{lat:40.7128,lng:-74.006},openingHours:{monday:{open:"09:00",close:"17:00"},tuesday:{open:"09:00",close:"17:00"},wednesday:{open:"09:00",close:"17:00"},thursday:{open:"09:00",close:"17:00"},friday:{open:"09:00",close:"17:00"},saturday:{open:"10:00",close:"18:00"},sunday:null}}],i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(i),l=document.createElement("a");l.href=d,l.download="itinerary-template.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(d)},N=()=>{p(null);try{const n=JSON.parse(h),i=Array.isArray(n)?n:[n];j(i)}catch(n){j(null),p(`Invalid JSON: ${n.message}`)}},{validItems:s,invalids:c}=m.useMemo(()=>{const n={validItems:[],invalids:[]};return a&&a.forEach((i,d)=>{const l=I(i);l.ok?n.validItems.push(l.value):n.invalids.push({index:d,error:l.error})}),n},[a]),r=()=>{if(!s.length){p("No valid items to import");return}const n=Date.now(),i=s.map((d,l)=>({...d,id:(n+l).toString(),createdAt:new Date,completed:!1}));o(i)};return t.jsx("div",{className:"modal-backdrop",children:t.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true","aria-labelledby":"import-json-title",children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{id:"import-json-title",children:"Import Activities (JSON)"}),t.jsx(u,{className:"close-button",variant:"ghost","aria-label":"Close",onClick:e,children:"Ã—"})]}),t.jsxs("div",{className:"modal-body",children:[t.jsxs("div",{style:{marginBottom:12},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px"},children:[t.jsx("input",{type:"file",accept:"application/json,.json",onChange:n=>{const i=n.target.files&&n.target.files[0];i&&b(i)}}),t.jsx(u,{onClick:x,variant:"neutral",size:"sm",children:"ðŸ“¥ Download Template"})]}),y&&t.jsx("span",{style:{marginLeft:8},children:y})]}),t.jsx("textarea",{placeholder:"Paste JSON here (array of items)",value:h,onChange:n=>g(n.target.value),rows:12,style:{width:"100%",fontFamily:"monospace"}}),t.jsx("div",{style:{marginTop:8},children:t.jsx(u,{onClick:N,variant:"primary",size:"sm",children:"Validate"})}),f&&t.jsx("div",{className:"error",style:{marginTop:8,color:"red"},children:f}),a&&t.jsxs("div",{style:{marginTop:8},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Valid:"})," ",s.length]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Invalid:"})," ",c.length]}),c.length>0&&t.jsxs("details",{style:{marginTop:6},children:[t.jsx("summary",{children:"View invalid items"}),t.jsx("ul",{children:c.map(n=>t.jsxs("li",{children:["Item ",n.index+1,": ",n.error]},n.index))})]})]})]}),t.jsxs(S,{children:[t.jsx(u,{variant:"neutral",onClick:e,children:"Cancel"}),t.jsxs(u,{variant:"primary",onClick:r,disabled:!a||!s.length,children:["Import ",s.length?`(${s.length})`:""]})]})]})})}export{k as default};
