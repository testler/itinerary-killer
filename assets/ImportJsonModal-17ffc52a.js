import{j as n,r as f}from"./index-448d429d.js";const k={primary:"ik-btn--primary",neutral:"ik-btn--neutral",danger:"ik-btn--danger",ghost:"ik-btn--ghost"},S={sm:"ik-btn--sm",md:"ik-btn--md",lg:"ik-btn--lg"};function j({variant:e="primary",size:o="md",leftIcon:c,rightIcon:d,className:p,children:y,...h}){const m=["ik-btn",k[e],S[o],p].filter(Boolean).join(" ");return n.jsxs("button",{className:m,...h,children:[c,y,d]})}function I({align:e="end",className:o,children:c,...d}){const p={justifyContent:e==="start"?"flex-start":e==="center"?"center":e==="end"?"flex-end":"space-between"};return n.jsx("footer",{className:["ik-safe-footer",o].filter(Boolean).join(" "),...d,children:n.jsx("div",{className:"ik-safe-footer__row",style:p,children:c})})}function O(e){if(typeof e!="object"||e===null)return{ok:!1,error:"Item is not an object"};const o=[],c=typeof e.title=="string"&&e.title.trim()?String(e.title).trim():(o.push("title"),null),d=typeof e.description=="string"&&e.description.trim()?String(e.description).trim():(o.push("description"),null),p=typeof e.address=="string"?String(e.address).trim():(o.push("address"),null),y=typeof e.category=="string"?String(e.category).trim():(o.push("category"),null),h=e.priority==="low"||e.priority==="medium"||e.priority==="high"?e.priority:(o.push("priority (low|medium|high)"),null),m=Number.isFinite(e.estimatedDuration)&&e.estimatedDuration>0?Number(e.estimatedDuration):(o.push("estimatedDuration (>0 minutes)"),null),u=Number.isFinite(e.cost)&&e.cost>=0?Number(e.cost):(o.push("cost (>=0)"),null),x=typeof e.notes=="string"?String(e.notes):"",v=typeof e.isOpen=="boolean"?e.isOpen:!1,b=e.location&&typeof e.location=="object"&&Number.isFinite(e.location.lat)&&Number.isFinite(e.location.lng);b||o.push("location { lat:number, lng:number }");const N=b?{lat:Number(e.location.lat),lng:Number(e.location.lng)}:void 0;let r;if(e.openingHours&&typeof e.openingHours=="object"){r={};for(const[g,a]of Object.entries(e.openingHours)){if(a===null){r[g]=null;continue}a&&typeof a=="object"&&typeof a.open=="string"&&typeof a.close=="string"?r[g]={open:a.open,close:a.close}:o.push(`openingHours.${g} must be { open:string, close:string } or null`)}}return o.length?{ok:!1,error:`Invalid fields: ${o.join(", ")}`}:{ok:!0,value:{title:c,description:d,address:p,category:y,priority:h,estimatedDuration:m,cost:u,notes:x,isOpen:v,location:N,openingHours:r}}}function D({onClose:e,onImport:o}){const[c,d]=f.useState(""),[p,y]=f.useState(""),[h,m]=f.useState(null),[u,x]=f.useState(null),v=async t=>{const s=await t.text();y(t.name),d(s)},b=()=>{const t=[{title:"Example Activity",description:"A sample activity description",address:"123 Example Street, City, State",category:"Entertainment",priority:"medium",estimatedDuration:120,cost:25.5,notes:"Optional notes about this activity",isOpen:!0,location:{lat:40.7128,lng:-74.006},openingHours:{monday:{open:"09:00",close:"17:00"},tuesday:{open:"09:00",close:"17:00"},wednesday:{open:"09:00",close:"17:00"},thursday:{open:"09:00",close:"17:00"},friday:{open:"09:00",close:"17:00"},saturday:{open:"10:00",close:"18:00"},sunday:null}}],s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(s),l=document.createElement("a");l.href=i,l.download="itinerary-template.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)},N=()=>{m(null);try{const t=JSON.parse(c),s=Array.isArray(t)?t:[t];x(s)}catch(t){x(null),m(`Invalid JSON: ${t.message}`)}},{validItems:r,invalids:g}=f.useMemo(()=>{const t={validItems:[],invalids:[]};return u&&u.forEach((s,i)=>{const l=O(s);l.ok?t.validItems.push(l.value):t.invalids.push({index:i,error:l.error})}),t},[u]),a=async()=>{if(!r.length){m("No valid items to import");return}try{const t=Date.now(),s=r.map((i,l)=>({...i,id:(t+l).toString(),createdAt:new Date,completed:!1}));console.log(`Importing ${s.length} items:`,s.map(i=>({id:i.id,title:i.title,category:i.category,priority:i.priority,hasLocation:!!i.location,hasNotes:!!i.notes,hasOpeningHours:!!i.openingHours}))),await o(s),console.log("Import completed successfully")}catch(t){console.error("Import failed:",t),m(`Import failed: ${t instanceof Error?t.message:String(t)}`)}};return n.jsx("div",{className:"modal-backdrop",children:n.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true","aria-labelledby":"import-json-title",children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{id:"import-json-title",children:"Import Activities (JSON)"}),n.jsx(j,{className:"close-button",variant:"ghost","aria-label":"Close",onClick:e,children:"Ã—"})]}),n.jsxs("div",{className:"modal-body",children:[n.jsxs("div",{style:{marginBottom:12},children:[n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px"},children:[n.jsx("input",{type:"file",accept:"application/json,.json",onChange:t=>{const s=t.target.files&&t.target.files[0];s&&v(s)}}),n.jsx(j,{onClick:b,variant:"neutral",size:"sm",children:"ðŸ“¥ Download Template"})]}),p&&n.jsx("span",{style:{marginLeft:8},children:p})]}),n.jsx("textarea",{placeholder:"Paste JSON here (array of items)",value:c,onChange:t=>d(t.target.value),rows:12,style:{width:"100%",fontFamily:"monospace"}}),n.jsx("div",{style:{marginTop:8},children:n.jsx(j,{onClick:N,variant:"primary",size:"sm",children:"Validate"})}),h&&n.jsx("div",{className:"error",style:{marginTop:8,color:"red"},children:h}),u&&n.jsxs("div",{style:{marginTop:8},children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Valid:"})," ",r.length]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Invalid:"})," ",g.length]}),g.length>0&&n.jsxs("details",{style:{marginTop:6},children:[n.jsx("summary",{children:"View invalid items"}),n.jsx("ul",{children:g.map(t=>n.jsxs("li",{children:["Item ",t.index+1,": ",t.error]},t.index))})]})]})]}),n.jsxs(I,{children:[n.jsx(j,{variant:"neutral",onClick:e,children:"Cancel"}),n.jsxs(j,{variant:"primary",onClick:a,disabled:!u||!r.length,children:["Import ",r.length?`(${r.length})`:""]})]})]})})}export{D as default};
