import{r as m,j as o,B as u,S}from"./index-b034d9ca.js";function I(e){if(typeof e!="object"||e===null)return{ok:!1,error:"Item is not an object"};const i=[],g=typeof e.title=="string"&&e.title.trim()?String(e.title).trim():(i.push("title"),null),h=typeof e.description=="string"&&e.description.trim()?String(e.description).trim():(i.push("description"),null),y=typeof e.address=="string"?String(e.address).trim():(i.push("address"),null),v=typeof e.category=="string"?String(e.category).trim():(i.push("category"),null),f=e.priority==="low"||e.priority==="medium"||e.priority==="high"?e.priority:(i.push("priority (low|medium|high)"),null),p=Number.isFinite(e.estimatedDuration)&&e.estimatedDuration>0?Number(e.estimatedDuration):(i.push("estimatedDuration (>0 minutes)"),null),c=Number.isFinite(e.cost)&&e.cost>=0?Number(e.cost):(i.push("cost (>=0)"),null),j=typeof e.notes=="string"?String(e.notes):"",b=typeof e.isOpen=="boolean"?e.isOpen:!1,x=e.location&&typeof e.location=="object"&&Number.isFinite(e.location.lat)&&Number.isFinite(e.location.lng);x||i.push("location { lat:number, lng:number }");const N=x?{lat:Number(e.location.lat),lng:Number(e.location.lng)}:void 0;let l;if(e.openingHours&&typeof e.openingHours=="object"){l={};for(const[d,a]of Object.entries(e.openingHours)){if(a===null){l[d]=null;continue}a&&typeof a=="object"&&typeof a.open=="string"&&typeof a.close=="string"?l[d]={open:a.open,close:a.close}:i.push(`openingHours.${d} must be { open:string, close:string } or null`)}}return i.length?{ok:!1,error:`Invalid fields: ${i.join(", ")}`}:{ok:!0,value:{title:g,description:h,address:y,category:v,priority:f,estimatedDuration:p,cost:c,notes:j,isOpen:b,location:N,openingHours:l}}}function k({onClose:e,onImport:i}){const[g,h]=m.useState(""),[y,v]=m.useState(""),[f,p]=m.useState(null),[c,j]=m.useState(null),b=async t=>{const n=await t.text();v(t.name),h(n)},x=()=>{const t=[{title:"Example Activity",description:"A sample activity description",address:"123 Example Street, City, State",category:"Entertainment",priority:"medium",estimatedDuration:120,cost:25.5,notes:"Optional notes about this activity",isOpen:!0,location:{lat:40.7128,lng:-74.006},openingHours:{monday:{open:"09:00",close:"17:00"},tuesday:{open:"09:00",close:"17:00"},wednesday:{open:"09:00",close:"17:00"},thursday:{open:"09:00",close:"17:00"},friday:{open:"09:00",close:"17:00"},saturday:{open:"10:00",close:"18:00"},sunday:null}}],n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download="itinerary-template.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)},N=()=>{p(null);try{const t=JSON.parse(g),n=Array.isArray(t)?t:[t];j(n)}catch(t){j(null),p(`Invalid JSON: ${t.message}`)}},{validItems:l,invalids:d}=m.useMemo(()=>{const t={validItems:[],invalids:[]};return c&&c.forEach((n,s)=>{const r=I(n);r.ok?t.validItems.push(r.value):t.invalids.push({index:s,error:r.error})}),t},[c]),a=async()=>{if(!l.length){p("No valid items to import");return}try{const t=Date.now(),n=l.map((s,r)=>({...s,id:(t+r).toString(),createdAt:new Date,completed:!1}));console.log(`Importing ${n.length} items:`,n.map(s=>({id:s.id,title:s.title,category:s.category,priority:s.priority,hasLocation:!!s.location,hasNotes:!!s.notes,hasOpeningHours:!!s.openingHours}))),await i(n),console.log("Import completed successfully")}catch(t){console.error("Import failed:",t),p(`Import failed: ${t instanceof Error?t.message:String(t)}`)}};return o.jsx("div",{className:"modal-backdrop",children:o.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true","aria-labelledby":"import-json-title",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{id:"import-json-title",children:"Import Activities (JSON)"}),o.jsx(u,{className:"close-button",variant:"ghost","aria-label":"Close",onClick:e,children:"Ã—"})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px"},children:[o.jsx("input",{type:"file",accept:"application/json,.json",onChange:t=>{const n=t.target.files&&t.target.files[0];n&&b(n)}}),o.jsx(u,{onClick:x,variant:"neutral",size:"sm",children:"ðŸ“¥ Download Template"})]}),y&&o.jsx("span",{style:{marginLeft:8},children:y})]}),o.jsx("textarea",{placeholder:"Paste JSON here (array of items)",value:g,onChange:t=>h(t.target.value),rows:12,style:{width:"100%",fontFamily:"monospace"}}),o.jsx("div",{style:{marginTop:8},children:o.jsx(u,{onClick:N,variant:"primary",size:"sm",children:"Validate"})}),f&&o.jsx("div",{className:"error",style:{marginTop:8,color:"red"},children:f}),c&&o.jsxs("div",{style:{marginTop:8},children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Valid:"})," ",l.length]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Invalid:"})," ",d.length]}),d.length>0&&o.jsxs("details",{style:{marginTop:6},children:[o.jsx("summary",{children:"View invalid items"}),o.jsx("ul",{children:d.map(t=>o.jsxs("li",{children:["Item ",t.index+1,": ",t.error]},t.index))})]})]})]}),o.jsxs(S,{children:[o.jsx(u,{variant:"neutral",onClick:e,children:"Cancel"}),o.jsxs(u,{variant:"primary",onClick:a,disabled:!c||!l.length,children:["Import ",l.length?`(${l.length})`:""]})]})]})})}export{k as default};
