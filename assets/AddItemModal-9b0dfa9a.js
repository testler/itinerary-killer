import{c as Q,r as d,j as t,g as R,f as Z,a as ee,b as G}from"./index-296e4d3f.js";import{S as te}from"./search-17fea2b3.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),re=["Theme Parks","Restaurants","Shopping","Entertainment","Outdoor Activities","Museums","Sports","Nightlife","Other"],oe=["low","medium","high"];function ne({onClose:S,onAdd:z,userLocation:v}){const[o,j]=d.useState({title:"",description:"",address:"",category:"Other",priority:"medium",estimatedDuration:60,cost:0,notes:"",isOpen:!0}),[p,w]=d.useState(null),[I,_]=d.useState(!1),[l,f]=d.useState({}),[C,x]=d.useState({}),[P,T]=d.useState(!1),[$,A]=d.useState(null),[O,F]=d.useState(!1),[E,k]=d.useState(null),[D,b]=d.useState([]),[L,N]=d.useState(!1),[H,M]=d.useState(null);d.useEffect(()=>{v&&w({lat:v.lat,lng:v.lng})},[v]);const g=e=>{const{name:s,value:r}=e.target;j(i=>({...i,[s]:s==="estimatedDuration"||s==="cost"?Number(r):r})),l[s]&&f(i=>({...i,[s]:""}))},W=async()=>{if(!o.address.trim()){f(e=>({...e,address:"Please enter an address"}));return}_(!0);try{const e=await R(o.address);e?(w(e),f(s=>({...s,address:""}))):f(s=>({...s,address:"Address not found. Please try a different address."}))}catch{f(s=>({...s,address:"Error searching for address. Please try again."}))}finally{_(!1)}},q=e=>{g(e);const s=e.target.value;if(H&&clearTimeout(H),!s.trim()){b([]);return}const r=setTimeout(async()=>{try{if(V()){b([]);return}N(!0);const i=await Z(s);b(i)}catch{b([])}finally{N(!1)}},300);M(r)},B=async e=>{var s;try{if(V())return;N(!0);const r=await ee(e.place_id),i=r.name||o.title,u=r.formatted_address||e.description;let a=p;r.geometry&&r.geometry.location&&(a={lat:r.geometry.location.lat,lng:r.geometry.location.lng});let m=o.description;r.editorial_summary&&r.editorial_summary.overview?m=r.editorial_summary.overview:r.types&&r.types.length&&(m=r.types.map(c=>c.replace(/_/g," ")).join(", "));let h={};if(r.opening_hours&&r.opening_hours.periods)for(let c=0;c<7;c++){const n=r.opening_hours.periods.find(y=>y.open.day===c);n?h[c]={open:n.open.time.replace(/(\d{2})(\d{2})/,"$1:$2"),close:(s=n.close)!=null&&s.time?n.close.time.replace(/(\d{2})(\d{2})/,"$1:$2"):""}:h[c]=null}j(c=>({...c,title:i,address:u,description:m})),w(a),x(h),b([])}finally{N(!1)}},U=()=>{const e={};return o.title.trim()||(e.title="Title is required"),o.description.trim()||(e.description="Description is required"),p||(e.address="Please select a valid location"),o.estimatedDuration<=0&&(e.estimatedDuration="Duration must be greater than 0"),o.cost<0&&(e.cost="Cost cannot be negative"),f(e),Object.keys(e).length===0},X=e=>{if(e.preventDefault(),!U())return;if(!p){f(r=>({...r,address:"Please select a valid location"}));return}const s={title:o.title.trim(),description:o.description.trim(),location:p,address:o.address.trim(),category:o.category,priority:o.priority,estimatedDuration:o.estimatedDuration,cost:o.cost,notes:o.notes.trim(),isOpen:o.isOpen,openingHours:C};z(s)},Y=async()=>{var e;T(!0),A(null);try{const{title:s,address:r}=o;if(!s.trim()||!r.trim()){A("Please enter both a title and address first."),T(!1);return}const i=await G(s,r);if(i.opening_hours&&i.opening_hours.periods){const u={};for(let a=0;a<7;a++){const m=i.opening_hours.periods.find(h=>h.open.day===a);m?u[a]={open:m.open.time.replace(/(\d{2})(\d{2})/,"$1:$2"),close:(e=m.close)!=null&&e.time?m.close.time.replace(/(\d{2})(\d{2})/,"$1:$2"):""}:u[a]=null}x(u)}else A("No opening hours found for this place.")}catch(s){A("Failed to fetch hours: "+(s.message||s))}finally{T(!1)}},J=async()=>{var e;F(!0),k(null);try{const{title:s,address:r}=o;if(!s.trim()&&!r.trim()){k("Please enter at least a title or address."),F(!1);return}const i=await G(s,r),u=i.name||o.title,a=i.formatted_address||o.address;let m=o.description;i.editorial_summary&&i.editorial_summary.overview?m=i.editorial_summary.overview:i.types&&i.types.length&&(m=i.types.map(n=>n.replace(/_/g," ")).join(", "));let h=p;if(i.geometry&&i.geometry.location)h={lat:i.geometry.location.lat,lng:i.geometry.location.lng};else if(a&&!p){const n=await R(a);n&&(h=n)}let c={};if(i.opening_hours&&i.opening_hours.periods)for(let n=0;n<7;n++){const y=i.opening_hours.periods.find(K=>K.open.day===n);y?c[n]={open:y.open.time.replace(/(\d{2})(\d{2})/,"$1:$2"),close:(e=y.close)!=null&&e.time?y.close.time.replace(/(\d{2})(\d{2})/,"$1:$2"):""}:c[n]=null}j(n=>({...n,title:u,address:a,description:m})),w(h),x(c)}catch(s){k("Failed to auto-populate: "+(s.message||s))}finally{F(!1)}},V=()=>{var r;const e=navigator,s=(r=e==null?void 0:e.connection)==null?void 0:r.effectiveType;return s&&(s==="2g"||s==="slow-2g"||s==="3g")};return t.jsx("div",{className:"modal",onClick:S,children:t.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:"Add New Activity"}),t.jsx("button",{className:"close-button",onClick:S,children:t.jsx(se,{size:24})})]}),t.jsxs("form",{onSubmit:X,children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"title",children:"Title *"}),t.jsx("input",{type:"text",id:"title",name:"title",value:o.title,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:`scroll-into-view ${l.title?"error":""}`,placeholder:"e.g., Visit Disney World","aria-label":"Activity title"}),l.title&&t.jsx("span",{className:"error-text",children:l.title})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"description",children:"Description *"}),t.jsx("textarea",{id:"description",name:"description",value:o.description,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:`scroll-into-view ${l.description?"error":""}`,placeholder:"Describe what you want to do...",rows:3,"aria-label":"Activity description"}),l.description&&t.jsx("span",{className:"error-text",children:l.description})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"address",children:"Address *"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("input",{type:"text",id:"address",name:"address",value:o.address,onChange:q,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:`scroll-into-view ${l.address?"error":""}`,placeholder:"Enter address or search for location",style:{flex:1},"aria-autocomplete":"list","aria-expanded":D.length>0}),t.jsx("button",{type:"button",onClick:W,disabled:I,style:{padding:"0.75rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},"aria-label":"Search for address",children:I?"...":t.jsx(te,{size:16})})]}),l.address&&t.jsx("span",{className:"error-text",children:l.address}),L&&t.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Searching..."}),D.length>0&&t.jsx("ul",{style:{listStyle:"none",marginTop:"0.5rem",border:"1px solid #e5e7eb",borderRadius:6,maxHeight:200,overflowY:"auto",background:"white"},role:"listbox",children:D.map(e=>t.jsx("li",{style:{padding:"0.5rem 0.75rem",cursor:"pointer"},onClick:()=>B(e),role:"option","aria-selected":"false",children:e.description},e.place_id))}),p&&t.jsxs("p",{style:{fontSize:"0.75rem",color:"#10b981",marginTop:"0.25rem"},children:["ðŸ“ Location set: ",p.lat.toFixed(6),", ",p.lng.toFixed(6)]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"category",children:"Category"}),t.jsx("select",{id:"category",name:"category",value:o.category,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:"scroll-into-view","aria-label":"Activity category",children:re.map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"priority",children:"Priority"}),t.jsx("select",{id:"priority",name:"priority",value:o.priority,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:"scroll-into-view","aria-label":"Activity priority",children:oe.map(e=>t.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"estimatedDuration",children:"Duration (minutes) *"}),t.jsx("input",{type:"number",id:"estimatedDuration",name:"estimatedDuration",value:o.estimatedDuration,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:`scroll-into-view ${l.estimatedDuration?"error":""}`,min:"1","aria-label":"Activity estimated duration"}),l.estimatedDuration&&t.jsx("span",{className:"error-text",children:l.estimatedDuration})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"cost",children:"Estimated Cost ($)"}),t.jsx("input",{type:"number",id:"cost",name:"cost",value:o.cost,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:`scroll-into-view ${l.cost?"error":""}`,min:"0",step:"0.01","aria-label":"Activity estimated cost"}),l.cost&&t.jsx("span",{className:"error-text",children:l.cost})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",id:"isOpen",name:"isOpen",checked:o.isOpen,onChange:e=>j(s=>({...s,isOpen:e.target.checked})),"aria-label":"Is activity currently open"}),t.jsx("span",{children:"ðŸŸ¢ This place is currently open"})]}),t.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Uncheck if the place is closed or you want to mark it as unavailable"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"notes",children:"Additional Notes"}),t.jsx("textarea",{id:"notes",name:"notes",value:o.notes,onChange:g,onFocus:e=>e.currentTarget.scrollIntoView({behavior:"smooth",block:"center"}),className:"scroll-into-view",placeholder:"Any additional details...",rows:2,"aria-label":"Additional notes for activity"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Opening Hours"}),t.jsx("button",{type:"button",onClick:Y,disabled:P,style:{marginLeft:8},"aria-label":"Fetch opening hours from Google",children:P?"Fetching...":"Auto-populate from Google"}),$&&t.jsx("span",{className:"error-text",children:$}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",marginTop:8},children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((e,s)=>{var r,i;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[t.jsx("span",{style:{fontWeight:500},children:e}),t.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[t.jsx("input",{type:"time",value:((r=C[s])==null?void 0:r.open)||"",onChange:u=>x(a=>({...a,[s]:{...a[s]||{},open:u.target.value}})),"aria-label":`Open time for ${e}`}),t.jsx("span",{children:"-"}),t.jsx("input",{type:"time",value:((i=C[s])==null?void 0:i.close)||"",onChange:u=>x(a=>({...a,[s]:{...a[s]||{},close:u.target.value}})),"aria-label":`Close time for ${e}`})]})]},e)})})]}),t.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"1.5rem"},className:"sticky-actions",children:[t.jsx("button",{type:"button",onClick:S,"aria-label":"Cancel adding activity",style:{padding:"0.75rem 1.5rem",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Cancel"}),t.jsx("button",{type:"submit",className:"submit-button","aria-label":"Add activity",children:"Add Activity"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("button",{type:"button",onClick:J,disabled:O,style:{marginBottom:8},"aria-label":"Auto-populate all fields from Google",children:O?"Auto-populating...":"Auto-populate All Fields from Google"}),E&&t.jsx("span",{className:"error-text",children:E})]})]})]})})}export{ne as default};
