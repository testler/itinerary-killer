import{r as u,j as t}from"./index-7b3f35b5.js";function N(e){if(typeof e!="object"||e===null)return{ok:!1,error:"Item is not an object"};const n=[],m=typeof e.title=="string"&&e.title.trim()?String(e.title).trim():(n.push("title"),null),h=typeof e.description=="string"&&e.description.trim()?String(e.description).trim():(n.push("description"),null),g=typeof e.address=="string"?String(e.address).trim():(n.push("address"),null),j=typeof e.category=="string"?String(e.category).trim():(n.push("category"),null),y=e.priority==="low"||e.priority==="medium"||e.priority==="high"?e.priority:(n.push("priority (low|medium|high)"),null),p=Number.isFinite(e.estimatedDuration)&&e.estimatedDuration>0?Number(e.estimatedDuration):(n.push("estimatedDuration (>0 minutes)"),null),c=Number.isFinite(e.cost)&&e.cost>=0?Number(e.cost):(n.push("cost (>=0)"),null),f=typeof e.notes=="string"?String(e.notes):"",b=typeof e.isOpen=="boolean"?e.isOpen:!1,x=e.location&&typeof e.location=="object"&&Number.isFinite(e.location.lat)&&Number.isFinite(e.location.lng);x||n.push("location { lat:number, lng:number }");const v=x?{lat:Number(e.location.lat),lng:Number(e.location.lng)}:void 0;let i;if(e.openingHours&&typeof e.openingHours=="object"){i={};for(const[a,r]of Object.entries(e.openingHours)){if(r===null){i[a]=null;continue}r&&typeof r=="object"&&typeof r.open=="string"&&typeof r.close=="string"?i[a]={open:r.open,close:r.close}:n.push(`openingHours.${a} must be { open:string, close:string } or null`)}}return n.length?{ok:!1,error:`Invalid fields: ${n.join(", ")}`}:{ok:!0,value:{title:m,description:h,address:g,category:j,priority:y,estimatedDuration:p,cost:c,notes:f,isOpen:b,location:v,openingHours:i}}}function I({onClose:e,onImport:n}){const[m,h]=u.useState(""),[g,j]=u.useState(""),[y,p]=u.useState(null),[c,f]=u.useState(null),b=async o=>{const s=await o.text();j(o.name),h(s)},x=()=>{const o=[{title:"Example Activity",description:"A sample activity description",address:"123 Example Street, City, State",category:"Entertainment",priority:"medium",estimatedDuration:120,cost:25.5,notes:"Optional notes about this activity",isOpen:!0,location:{lat:40.7128,lng:-74.006},openingHours:{monday:{open:"09:00",close:"17:00"},tuesday:{open:"09:00",close:"17:00"},wednesday:{open:"09:00",close:"17:00"},thursday:{open:"09:00",close:"17:00"},friday:{open:"09:00",close:"17:00"},saturday:{open:"10:00",close:"18:00"},sunday:null}}],s=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),d=URL.createObjectURL(s),l=document.createElement("a");l.href=d,l.download="itinerary-template.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(d)},v=()=>{p(null);try{const o=JSON.parse(m),s=Array.isArray(o)?o:[o];f(s)}catch(o){f(null),p(`Invalid JSON: ${o.message}`)}},{validItems:i,invalids:a}=u.useMemo(()=>{const o={validItems:[],invalids:[]};return c&&c.forEach((s,d)=>{const l=N(s);l.ok?o.validItems.push(l.value):o.invalids.push({index:d,error:l.error})}),o},[c]),r=()=>{if(!i.length){p("No valid items to import");return}const o=Date.now(),s=i.map((d,l)=>({...d,id:(o+l).toString(),createdAt:new Date,completed:!1}));n(s)};return t.jsx("div",{className:"modal-backdrop",children:t.jsxs("div",{className:"modal",children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:"Import Activities (JSON)"}),t.jsx("button",{className:"close-button",onClick:e,children:"Ã—"})]}),t.jsxs("div",{className:"modal-body",children:[t.jsxs("div",{style:{marginBottom:12},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px"},children:[t.jsx("input",{type:"file",accept:"application/json,.json",onChange:o=>{const s=o.target.files&&o.target.files[0];s&&b(s)}}),t.jsx("button",{onClick:x,style:{padding:"6px 12px",backgroundColor:"#f0f0f0",border:"1px solid #ccc",borderRadius:"4px",cursor:"pointer"},children:"ðŸ“¥ Download Template"})]}),g&&t.jsx("span",{style:{marginLeft:8},children:g})]}),t.jsx("textarea",{placeholder:"Paste JSON here (array of items)",value:m,onChange:o=>h(o.target.value),rows:12,style:{width:"100%",fontFamily:"monospace"}}),t.jsx("div",{style:{marginTop:8},children:t.jsx("button",{onClick:v,children:"Validate"})}),y&&t.jsx("div",{className:"error",style:{marginTop:8,color:"red"},children:y}),c&&t.jsxs("div",{style:{marginTop:8},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Valid:"})," ",i.length]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Invalid:"})," ",a.length]}),a.length>0&&t.jsxs("details",{style:{marginTop:6},children:[t.jsx("summary",{children:"View invalid items"}),t.jsx("ul",{children:a.map(o=>t.jsxs("li",{children:["Item ",o.index+1,": ",o.error]},o.index))})]})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{onClick:e,children:"Cancel"}),t.jsxs("button",{onClick:r,disabled:!c||!i.length,children:["Import ",i.length?`(${i.length})`:""]})]})]})})}export{I as default};
